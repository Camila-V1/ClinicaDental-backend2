# ğŸ¨ GuÃ­a Visual del Chatbot

## ğŸ“ Arquitectura Completa

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FLUTTER APP (Mobile)                   â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Screens (UI)                              â”‚  â”‚
â”‚  â”‚  â€¢ ChatScreen                                     â”‚  â”‚
â”‚  â”‚  â€¢ ConversacionesScreen                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                    â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Providers (State Management)              â”‚  â”‚
â”‚  â”‚  â€¢ ChatbotProvider                                â”‚  â”‚
â”‚  â”‚    - mensajes[]                                   â”‚  â”‚
â”‚  â”‚    - isTyping                                     â”‚  â”‚
â”‚  â”‚    - enviarMensaje()                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                    â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Services (API Calls)                      â”‚  â”‚
â”‚  â”‚  â€¢ ChatbotService                                 â”‚  â”‚
â”‚  â”‚    - enviarMensaje()                              â”‚  â”‚
â”‚  â”‚    - obtenerConversaciones()                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP/REST
                     â”‚ + JWT Token
                     â”‚ + X-Tenant-ID
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DJANGO BACKEND (API)                       â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         URLs (Routing)                           â”‚  â”‚
â”‚  â”‚  POST /api/chatbot/chat/                         â”‚  â”‚
â”‚  â”‚  GET  /api/chatbot/conversaciones/               â”‚  â”‚
â”‚  â”‚  GET  /api/chatbot/conversaciones/{id}/          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                    â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Views (Controllers)                      â”‚  â”‚
â”‚  â”‚  â€¢ ChatBotView.post()                            â”‚  â”‚
â”‚  â”‚  â€¢ ConversacionListView.get()                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                    â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         IA Service                               â”‚  â”‚
â”‚  â”‚  â€¢ ChatbotService.generar_respuesta()            â”‚  â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â”‚
â”‚  â”‚    â”‚  OpenAI GPT / Gemini     â”‚                  â”‚  â”‚
â”‚  â”‚    â”‚  o Respuestas Locales    â”‚                  â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                    â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Models (Database)                        â”‚  â”‚
â”‚  â”‚  â€¢ Conversacion                                  â”‚  â”‚
â”‚  â”‚  â€¢ Mensaje                                       â”‚  â”‚
â”‚  â”‚  â€¢ IntentoChatbot                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              POSTGRESQL DATABASE                      â”‚
â”‚  Schema: clinica_demo                                 â”‚
â”‚  Tables:                                              â”‚
â”‚  â€¢ chatbot_conversacion                               â”‚
â”‚  â€¢ chatbot_mensaje                                    â”‚
â”‚  â€¢ chatbot_intentochatbot                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flujo de Mensajes

### Flujo Completo (Usuario â†’ Bot â†’ Usuario)

```
1. USUARIO escribe mensaje
   â†“
2. FLUTTER: ChatInput captura texto
   â†“
3. FLUTTER: Provider.enviarMensaje()
   â†“
4. FLUTTER: Service hace POST /api/chatbot/chat/
   {
     "mensaje": "Â¿CuÃ¡les son los horarios?",
     "conversacion_id": 1
   }
   â†“
5. BACKEND: ChatBotView.post() recibe request
   â†“
6. BACKEND: Guarda mensaje del usuario en BD
   INSERT INTO chatbot_mensaje (role='user', content='Â¿CuÃ¡les...?')
   â†“
7. BACKEND: Obtiene historial de conversaciÃ³n
   SELECT * FROM chatbot_mensaje WHERE conversacion_id=1 ORDER BY timestamp
   â†“
8. BACKEND: ChatbotService.generar_respuesta()
   â”œâ”€â”€ OpciÃ³n A: Llama a OpenAI API
   â”œâ”€â”€ OpciÃ³n B: Llama a Google Gemini
   â””â”€â”€ OpciÃ³n C: Usa respuestas locales (IntentoChatbot)
   â†“
9. BACKEND: Guarda respuesta del bot en BD
   INSERT INTO chatbot_mensaje (role='assistant', content='Nuestros horarios...')
   â†“
10. BACKEND: Devuelve JSON
    {
      "conversacion_id": 1,
      "mensaje_usuario": {...},
      "mensaje_bot": {
        "content": "Nuestros horarios son: Lunes a Viernes 8AM-8PM..."
      }
    }
   â†“
11. FLUTTER: Service recibe respuesta
   â†“
12. FLUTTER: Provider actualiza estado
    _mensajes.add(mensaje_bot)
    notifyListeners()
   â†“
13. FLUTTER: UI se actualiza automÃ¡ticamente
   â†“
14. USUARIO ve la respuesta del bot
```

---

## ğŸ–¼ï¸ Wireframes de las Pantallas

### ChatScreen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† DentalBot ğŸ¦·            ğŸ”„        â”‚ AppBar
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ˜Š Hola! Soy MarÃ­a          â”‚  â”‚ Usuario
â”‚  â”‚    14:30                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Â¡Hola MarÃ­a! ğŸ‘‹              â”‚   â”‚ Bot
â”‚ â”‚ Soy DentalBot, tu asistente  â”‚   â”‚
â”‚ â”‚ virtual. Â¿En quÃ© puedo       â”‚   â”‚
â”‚ â”‚ ayudarte hoy?                â”‚   â”‚
â”‚ â”‚                        14:30 â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Â¿CuÃ¡les son los horarios?   â”‚  â”‚ Usuario
â”‚  â”‚    14:31                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ• Nuestros horarios:        â”‚   â”‚ Bot
â”‚ â”‚ Lunes a Viernes: 8AM-8PM     â”‚   â”‚
â”‚ â”‚ SÃ¡bados: 9AM-2PM             â”‚   â”‚
â”‚ â”‚ Domingos: Cerrado            â”‚   â”‚
â”‚ â”‚                        14:31 â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ â—‹ â—‹ â—‹   Escribiendo...             â”‚ Typing
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’¡ â”‚ Escribe tu mensaje...    â”‚ğŸ“¨ â”‚ Input
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ConversacionesScreen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Mis Conversaciones                â”‚ AppBar
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ¤–  Consulta sobre horarios    â”‚ â”‚
â”‚ â”‚     Nuestros horarios son...   â”‚ â”‚
â”‚ â”‚                  hace 2 horas  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ¤–  Agendar cita dental        â”‚ â”‚
â”‚ â”‚     Para agendar tu cita...    â”‚ â”‚
â”‚ â”‚                     ayer       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ¤–  Precios de tratamientos    â”‚ â”‚
â”‚ â”‚     Los precios son...         â”‚ â”‚
â”‚ â”‚                  hace 3 dÃ­as   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ¤–  UbicaciÃ³n de la clÃ­nica    â”‚ â”‚
â”‚ â”‚     Estamos ubicados en...     â”‚ â”‚
â”‚ â”‚                hace 1 semana   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”Œâ”€â”€â”€â”€â”
                    â”‚ â• â”‚ FAB (Nueva conversaciÃ³n)
                    â””â”€â”€â”€â”€â”˜
```

### Sugerencias RÃ¡pidas (Bottom Sheet)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚  Sugerencias                        â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Â¿CuÃ¡les son los horarios?      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Quiero agendar una cita        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Â¿CuÃ¡nto cuesta una limpieza?   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Ver mis prÃ³ximas citas         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Estructura de Base de Datos

```sql
-- Tabla: chatbot_conversacion
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ chatbot_conversacion                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)   â”‚ INTEGER   â”‚ Auto          â”‚
â”‚ usuario_idâ”‚ FK        â”‚ â†’ usuarios    â”‚
â”‚ titulo    â”‚ VARCHAR   â”‚ Max 200       â”‚
â”‚ created_atâ”‚ TIMESTAMP â”‚ Auto          â”‚
â”‚ updated_atâ”‚ TIMESTAMP â”‚ Auto          â”‚
â”‚ is_active â”‚ BOOLEAN   â”‚ Default: true â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

-- Tabla: chatbot_mensaje
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ chatbot_mensaje                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)       â”‚ INTEGER   â”‚ Auto      â”‚
â”‚ conversacion_idâ”‚ FK       â”‚ â†’ conversacion
â”‚ role          â”‚ VARCHAR   â”‚ user/assistant
â”‚ content       â”‚ TEXT      â”‚           â”‚
â”‚ timestamp     â”‚ TIMESTAMP â”‚ Auto      â”‚
â”‚ metadata      â”‚ JSONB     â”‚ Nullable  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

-- Tabla: chatbot_intentochatbot
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ chatbot_intentochatbot                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚ INTEGER   â”‚ Auto    â”‚
â”‚ nombre          â”‚ VARCHAR   â”‚ Unique  â”‚
â”‚ descripcion     â”‚ TEXT      â”‚         â”‚
â”‚ ejemplos        â”‚ JSONB     â”‚ Array   â”‚
â”‚ respuesta_templateâ”‚ TEXT    â”‚         â”‚
â”‚ requiere_autent â”‚ BOOLEAN   â”‚ Default â”‚
â”‚ is_active       â”‚ BOOLEAN   â”‚ Default â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

-- Relaciones:
Conversacion â”€â”€â”¬â”€< Mensaje
               â”‚
Usuario â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Ejemplo de Datos

### Conversacion

```json
{
  "id": 1,
  "usuario_id": 1004,
  "titulo": "Consulta sobre horarios",
  "created_at": "2025-11-27T14:30:00Z",
  "updated_at": "2025-11-27T14:35:00Z",
  "is_active": true
}
```

### Mensaje (Usuario)

```json
{
  "id": 1,
  "conversacion_id": 1,
  "role": "user",
  "content": "Â¿CuÃ¡les son los horarios de atenciÃ³n?",
  "timestamp": "2025-11-27T14:30:00Z",
  "metadata": {}
}
```

### Mensaje (Bot)

```json
{
  "id": 2,
  "conversacion_id": 1,
  "role": "assistant",
  "content": "ğŸ• Nuestros horarios de atenciÃ³n son:\n\nğŸ“… Lunes a Viernes: 8:00 AM - 8:00 PM\nğŸ“… SÃ¡bados: 9:00 AM - 2:00 PM\nğŸ“… Domingos: Cerrado",
  "timestamp": "2025-11-27T14:30:05Z",
  "metadata": {
    "model": "gpt-3.5-turbo",
    "tokens_usados": 87,
    "intento": "consultar_horarios"
  }
}
```

---

## ğŸ¨ Paleta de Colores Recomendada

```dart
// theme_data.dart

ThemeData chatbotTheme = ThemeData(
  primaryColor: Color(0xFF2196F3),     // Azul principal
  primaryColorLight: Color(0xFF64B5F6), // Azul claro
  primaryColorDark: Color(0xFF1976D2),  // Azul oscuro
  
  colorScheme: ColorScheme.light(
    primary: Color(0xFF2196F3),
    secondary: Color(0xFF4CAF50),      // Verde (bot)
    surface: Colors.white,
    background: Color(0xFFF5F5F5),
    error: Color(0xFFF44336),
  ),
  
  // Colores especÃ­ficos del chat
  extensions: [
    ChatColors(
      userBubble: Color(0xFF2196F3),   // Azul
      botBubble: Color(0xFFE0E0E0),    // Gris claro
      userText: Colors.white,
      botText: Colors.black87,
      timestamp: Colors.grey,
      typingIndicator: Colors.grey,
    ),
  ],
);
```

---

## ğŸ“ˆ MÃ©tricas y Analytics (Futuro)

```python
# MÃ©tricas que se pueden rastrear:

class MensajeMetrics(models.Model):
    """MÃ©tricas de uso del chatbot."""
    
    fecha = models.DateField(auto_now_add=True)
    total_mensajes = models.IntegerField(default=0)
    mensajes_usuario = models.IntegerField(default=0)
    mensajes_bot = models.IntegerField(default=0)
    conversaciones_nuevas = models.IntegerField(default=0)
    usuarios_activos = models.IntegerField(default=0)
    tiempo_respuesta_promedio = models.FloatField(default=0)
    intento_mas_usado = models.CharField(max_length=100)
    satisfaccion_promedio = models.FloatField(null=True)
```

Dashboard de mÃ©tricas:
- ğŸ“Š Mensajes por dÃ­a
- ğŸ‘¥ Usuarios activos
- â±ï¸ Tiempo de respuesta promedio
- ğŸ¯ Intentos mÃ¡s consultados
- â­ SatisfacciÃ³n del usuario

---

## ğŸ”® Roadmap de Funcionalidades

### Fase 1 (Actual)
- âœ… Chat bÃ¡sico texto
- âœ… Historial de conversaciones
- âœ… Respuestas con IA (OpenAI/Gemini)
- âœ… Sugerencias rÃ¡pidas

### Fase 2 (PrÃ³xima)
- ğŸ”„ WebSockets (tiempo real)
- ğŸ¤ Reconocimiento de voz
- ğŸ”Š Texto a voz
- ğŸ“ Enviar imÃ¡genes/archivos

### Fase 3 (Futuro)
- ğŸ¤– Avatar animado del bot
- ğŸŒ Soporte multiidioma
- ğŸ’¬ IntegraciÃ³n con WhatsApp
- ğŸ“Š Analytics detallado
- â­ Rating de respuestas

---

Â¡Tu chatbot estÃ¡ listo para revolucionar la experiencia del usuario! ğŸš€
