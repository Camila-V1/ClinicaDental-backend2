###
# ü¶∑ PRUEBAS: Endpoints de Odontograma
# Base URL: /api/historial/odontogramas/
###

### 1. Login como odont√≥logo
POST http://clinica-demo.localhost:8000/api/token/
Content-Type: application/json

{
  "email": "odontologo1@test.com",
  "password": "odonto123"
}

### Variable para token
# @token = {{$1.response.body.access}}

### 2. üìã Listar todos los odontogramas (del tenant)
GET http://clinica-demo.localhost:8000/api/historial/odontogramas/
Authorization: Bearer {{token}}
Host: clinica-demo.localhost

### 3. üìÑ Ver detalle de un odontograma espec√≠fico
GET http://clinica-demo.localhost:8000/api/historial/odontogramas/1/
Authorization: Bearer {{token}}
Host: clinica-demo.localhost

### 4. ‚ûï Crear nuevo odontograma (historial_clinico_id debe existir)
POST http://clinica-demo.localhost:8000/api/historial/odontogramas/
Authorization: Bearer {{token}}
Host: clinica-demo.localhost
Content-Type: application/json

{
  "historial_clinico": 1,
  "estado_piezas": {
    "11": {
      "estado": "sano",
      "notas": ""
    },
    "12": {
      "estado": "caries",
      "superficie": ["oclusal"],
      "notas": "Caries profunda"
    },
    "13": {
      "estado": "restaurado",
      "material": "resina",
      "notas": "Restauraci√≥n reciente"
    },
    "21": {
      "estado": "sano"
    },
    "22": {
      "estado": "endodoncia",
      "notas": "Tratamiento de conducto completado"
    },
    "31": {
      "estado": "corona",
      "material": "porcelana",
      "notas": "Corona de porcelana"
    },
    "32": {
      "estado": "extraido",
      "fecha_extraccion": "2024-05-10",
      "notas": "Extracci√≥n quir√∫rgica"
    }
  },
  "notas": "Primera evaluaci√≥n completa. Paciente presenta m√∫ltiples caries."
}

### 5. ‚úèÔ∏è Actualizar odontograma existente
PUT http://clinica-demo.localhost:8000/api/historial/odontogramas/1/
Authorization: Bearer {{token}}
Host: clinica-demo.localhost
Content-Type: application/json

{
  "estado_piezas": {
    "11": {
      "estado": "sano"
    },
    "12": {
      "estado": "restaurado",
      "superficie": ["oclusal"],
      "material": "resina",
      "notas": "Caries tratada exitosamente"
    },
    "13": {
      "estado": "restaurado",
      "material": "resina"
    }
  },
  "notas": "Actualizaci√≥n post-tratamiento. Caries de pieza 12 restaurada."
}

### 6. üìã Actualizaci√≥n parcial (PATCH)
PATCH http://clinica-demo.localhost:8000/api/historial/odontogramas/1/
Authorization: Bearer {{token}}
Host: clinica-demo.localhost
Content-Type: application/json

{
  "notas": "Notas adicionales: Paciente reporta sensibilidad en pieza 12."
}

### 7. üìã Duplicar odontograma (crear nueva versi√≥n)
POST http://clinica-demo.localhost:8000/api/historial/odontogramas/1/duplicar_odontograma/
Authorization: Bearer {{token}}
Host: clinica-demo.localhost

### 8. üóëÔ∏è Eliminar odontograma
DELETE http://clinica-demo.localhost:8000/api/historial/odontogramas/2/
Authorization: Bearer {{token}}
Host: clinica-demo.localhost

### 9. üìã Crear odontograma COMPLETO (32 piezas adulto - FDI)
POST http://clinica-demo.localhost:8000/api/historial/odontogramas/
Authorization: Bearer {{token}}
Host: clinica-demo.localhost
Content-Type: application/json

{
  "historial_clinico": 1,
  "estado_piezas": {
    "11": {"estado": "sano"},
    "12": {"estado": "sano"},
    "13": {"estado": "sano"},
    "14": {"estado": "sano"},
    "15": {"estado": "sano"},
    "16": {"estado": "restaurado", "material": "amalgama"},
    "17": {"estado": "sano"},
    "18": {"estado": "extraido"},
    "21": {"estado": "sano"},
    "22": {"estado": "sano"},
    "23": {"estado": "sano"},
    "24": {"estado": "sano"},
    "25": {"estado": "sano"},
    "26": {"estado": "corona", "material": "porcelana"},
    "27": {"estado": "sano"},
    "28": {"estado": "extraido"},
    "31": {"estado": "sano"},
    "32": {"estado": "sano"},
    "33": {"estado": "sano"},
    "34": {"estado": "sano"},
    "35": {"estado": "caries", "superficie": ["oclusal", "distal"]},
    "36": {"estado": "endodoncia"},
    "37": {"estado": "sano"},
    "38": {"estado": "sano"},
    "41": {"estado": "sano"},
    "42": {"estado": "sano"},
    "43": {"estado": "sano"},
    "44": {"estado": "sano"},
    "45": {"estado": "sano"},
    "46": {"estado": "restaurado", "material": "resina"},
    "47": {"estado": "sano"},
    "48": {"estado": "sano"}
  },
  "notas": "Odontograma completo - 32 piezas. Nomenclatura FDI."
}

### 10. üìã Login como paciente y ver SU odontograma
POST http://clinica-demo.localhost:8000/api/token/
Content-Type: application/json

{
  "email": "paciente1@test.com",
  "password": "paciente123"
}

### Variable para token paciente
# @token_paciente = {{$10.response.body.access}}

### 11. üìã Paciente lista sus odontogramas
GET http://clinica-demo.localhost:8000/api/historial/odontogramas/
Authorization: Bearer {{token_paciente}}
Host: clinica-demo.localhost

###
# üìù ESTRUCTURA DEL CAMPO estado_piezas (JSON):
# {
#   "11": {  // N√∫mero de pieza dental (FDI)
#     "estado": "sano|caries|restaurado|corona|endodoncia|extraido",
#     "superficie": ["oclusal", "mesial", "distal", "vestibular", "lingual"],
#     "material": "resina|amalgama|porcelana|zirconio",
#     "notas": "Observaciones espec√≠ficas de la pieza",
#     "fecha_extraccion": "YYYY-MM-DD" // Si aplica
#   }
# }
#
# NOMENCLATURA FDI (Internacional):
# - Adultos (32 piezas): 11-18, 21-28, 31-38, 41-48
# - Ni√±os (20 piezas): 51-55, 61-65, 71-75, 81-85
#
# Estados comunes:
# - sano: Diente sin patolog√≠as
# - caries: Diente con caries activa
# - restaurado: Diente con obturaci√≥n/restauraci√≥n
# - corona: Diente con corona prot√©sica
# - endodoncia: Tratamiento de conducto
# - extraido: Pieza ausente
# - implante: Implante dental
# - fracturado: Diente fracturado
# - movilidad: Diente con movilidad
#
# Superficies dentales:
# - oclusal: Superficie de masticaci√≥n
# - mesial: Cara hacia el centro
# - distal: Cara hacia afuera
# - vestibular: Cara externa (hacia labios/mejillas)
# - lingual: Cara interna (hacia lengua)
###

###
# üìå RESPUESTA ESPERADA:
# {
#   "id": 1,
#   "fecha_snapshot": "2025-11-09T21:30:00.000000Z",
#   "estado_piezas": {
#     "11": {"estado": "sano"},
#     "12": {"estado": "caries", "superficie": ["oclusal"], "notas": "Caries profunda"}
#   },
#   "notas": "Primera evaluaci√≥n completa"
# }
###
