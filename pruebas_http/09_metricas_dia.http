###
# üìä PRUEBAS: Endpoint de M√©tricas del D√≠a
# Endpoint: GET /api/agenda/citas/metricas-dia/
#
# üîë TOKENS FIJOS:
# - Token Odont√≥logo: Ejecuta PASO 0 primero
# - Devuelve m√©tricas del d√≠a actual para el dashboard
###

### PASO 0: Login como ODONT√ìLOGO
# @name loginOdonto
POST http://clinica-demo.localhost:8000/api/token/
Content-Type: application/json

{
  "email": "odontologo@clinica-demo.com",
  "password": "odontologo123"
}

###

### 1. üìä Obtener m√©tricas del d√≠a (Odont√≥logo)
GET http://clinica-demo.localhost:8000/api/agenda/citas/metricas-dia/
Authorization: Bearer {{loginOdonto.response.body.access}}
Host: clinica-demo.localhost

###

### 2. ‚ùå ERROR: Intentar acceder como paciente (debe fallar)
# @name loginPaciente
POST http://clinica-demo.localhost:8000/api/token/
Content-Type: application/json

{
  "email": "paciente@test.com",
  "password": "paciente123"
}

### 2B. Intentar m√©tricas como paciente
GET http://clinica-demo.localhost:8000/api/agenda/citas/metricas-dia/
Authorization: Bearer {{loginPaciente.response.body.access}}
Host: clinica-demo.localhost

###
# üìù RESPUESTA ESPERADA (Odont√≥logo):
# {
#   "fecha": "2025-11-09",
#   "citas_hoy": 5,
#   "citas_pendientes": 2,
#   "citas_confirmadas": 1,
#   "citas_atendidas": 2,
#   "pacientes_atendidos": 2,
#   "proxima_cita": {
#     "id": 1,
#     "hora": "15:00",
#     "paciente": "Juan P√©rez",
#     "motivo": "Revisi√≥n",
#     "estado": "CONFIRMADA",
#     "minutos_restantes": 45
#   }
# }
#
# Si no hay pr√≥xima cita:
# {
#   ...
#   "proxima_cita": null
# }
###

###
# üìå NOTAS:
# - Solo odont√≥logos pueden acceder a este endpoint
# - Muestra solo las citas del odont√≥logo autenticado
# - La fecha siempre es la fecha actual del servidor
# - minutos_restantes puede ser 0 si la cita ya pas√≥ pero a√∫n est√° pendiente
# - pacientes_atendidos cuenta pacientes √∫nicos (un paciente puede tener varias citas)
###
